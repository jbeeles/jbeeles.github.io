<!DOCTYPE html>
<html>
    <head>
      <meta charset="UTF-8">
      <title>Project 5</title>
	  <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.1.2/handlebars.min.js"></script>
  </head>
<body>
  
<div class="container">
<h2>Select a Major</h2>
  
<div style='padding: 5px;'>
<button type='button' class="btn btn-info" onClick="getData('CIT')">CIT Majors</button> &nbsp; 
<button type='button' class="btn btn-info" onClick="getData('BUS')">Business Majors</button>
</div>
  
  
<h3>We filter our dataset by major</h3>
<div id="majorTable"></div>
  
  


</div> 
</body>



<script type="text/x-handlebars-template" id="tableTemplate">

<table class="table table-striped">
<tr><th>Name</th><th>Major</th><th>Midterm</th><th>Final</th></tr>
{{#each rows}}
<tr>
<td>{{name}}</td><td>{{major}}</td><td>{{midterm}}</td><td>{{final}}</td>
</tr>
{{/each}}
</table>
</script>
  

<script>
 function getData(selected_major) {
    var request = new XMLHttpRequest();
    var url = "cit5students.json";
    request.open('GET', url);
   
      request.onload = function() {                    
         var data = JSON.parse(request.responseText);    

         major_items = data.filter(getMajor)       
         function getMajor(item) {
            return item.major == selected_major;   
         }
        
        if (request.status == 200) {    
            var templateText = document.getElementById('tableTemplate').innerHTML;
            var compiledTemplateText = Handlebars.compile(templateText);       
            compiledHtml = compiledTemplateText({ rows: major_items })          
            document.getElementById('majorTable').innerHTML = compiledHtml; 
        }
        else {
            document.querySelector('#majorTable').innerHTML = "Danger Will Robinson,there was an error";
        }
     }
     
     request.send(null);
   
  
   </script>
</html>
